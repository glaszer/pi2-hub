<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pi² | Engineering Terminal</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root {
            /* BLUEPRINT PALETTE */
            --bg-paper: #F2F2F0;
            --bg-card: #FFFFFF;
            --ink: #050505;
            --ink-dim: #555555;
            --accent: #7F2FFF;
            --highlight: #FFC700;
            
            --shadow-hard: 6px 6px 0px var(--ink);
            --shadow-hover: 3px 3px 0px var(--ink);
            --border-thick: 3px solid var(--ink);
            --border-thin: 2px solid var(--ink);
            
            /* Roles */
            --role-harmony: #FF0080;
            --role-luminary: #F59E0B;
            --role-catalyst: #7F2FFF;
            --role-neophyte: #3B82F6;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        
        body {
            background-color: var(--bg-paper);
            /* Инженерная сетка */
            background-image: 
                linear-gradient(var(--ink) 1px, transparent 1px),
                linear-gradient(90deg, var(--ink) 1px, transparent 1px);
            background-size: 40px 40px;
            
            color: var(--ink); font-family: 'Space Grotesk', sans-serif;
            
            height: 100vh; width: 100vw;
            display: grid; place-items: center;
            overflow: hidden;
        }
        
        body::after {
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-paper); opacity: 0.94; z-index: -1;
        }

        /* CONTAINER */
        .interface {
            position: relative; z-index: 10;
            width: 96%; max-width: 1380px; 
            height: 90vh; min-height: 700px;
            
            background: var(--bg-card);
            border: var(--border-thick);
            box-shadow: 15px 15px 0px rgba(0,0,0,0.15);
            display: flex; flex-direction: column; overflow: hidden;
        }

        /* DECOR CORNERS */
        .interface::before, .interface::after {
            content: "+"; position: absolute; font-family: 'JetBrains Mono'; font-weight: 900; font-size: 20px;
            width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;
            border: 2px solid var(--ink); background: var(--highlight); z-index: 20;
        }
        .interface::before { top: -2px; left: -2px; border-right: 3px solid var(--ink); border-bottom: 3px solid var(--ink); }
        .interface::after { bottom: -2px; right: -2px; border-left: 3px solid var(--ink); border-top: 3px solid var(--ink); }

        /* HEADER */
        header { display: flex; justify-content: space-between; align-items: center; padding: 20px 40px; border-bottom: 3px solid var(--ink); background: #fff; flex-shrink: 0; }
        .logo-group { display: flex; align-items: center; gap: 15px; }
        .custom-logo { height: 40px; border: 2px solid var(--ink); box-shadow: 4px 4px 0 var(--ink); }
        .logo-text { font-family: 'JetBrains Mono'; font-weight: 700; font-size: 24px; text-transform: uppercase; letter-spacing: -1px; }
        .badge { background: var(--bg-paper); color: var(--ink); padding: 6px 16px; font-family: 'JetBrains Mono'; font-size: 12px; font-weight: 700; border: 2px solid var(--ink); display: flex; align-items: center; gap: 8px; box-shadow: 4px 4px 0px var(--ink); }
        .dot { width: 10px; height: 10px; background: #00FF00; border: 1px solid var(--ink); }

        /* NAV */
        nav { display: flex; justify-content: center; gap: 0; border-bottom: 3px solid var(--ink); background: var(--bg-paper); flex-shrink: 0; padding: 0; overflow-x: auto;}
        .nav-btn {
            padding: 16px 30px; border: none; background: transparent;
            font-family: 'JetBrains Mono', monospace; font-weight: 700; font-size: 14px; text-transform: uppercase;
            cursor: pointer; border-right: 2px solid var(--ink); transition: 0.1s; white-space: nowrap;
        }
        .nav-btn:first-child { border-left: 2px solid var(--ink); }
        .nav-btn:hover { background: #fff; }
        .nav-btn.active { background: var(--accent); color: #fff; box-shadow: inset 0px -4px 0px rgba(0,0,0,0.3); }

        /* SCREEN */
        .screen { flex: 1; position: relative; overflow: hidden; background: #fff; }
        .tab-content { display: none; width: 100%; height: 100%; overflow-y: auto; opacity: 1; }
        .tab-content.active { display: flex; flex-direction: column; }
        #tab-dashboard.active { display: block; } 

        /* DASHBOARD LAYOUT */
        .dash-container { display: grid; grid-template-columns: 1fr 380px; height: 100%; width: 100%; }
        .dash-left { 
            padding: 40px; overflow-y: auto; display: flex; flex-direction: column; align-items: center; 
            background-image: radial-gradient(var(--ink) 1px, transparent 1px); background-size: 20px 20px; background-color: #fff;
        }
        .dash-wrapper { width: 100%; max-width: 1000px; display: flex; flex-direction: column; gap: 40px; z-index: 2; }
        .dash-right { background: var(--bg-paper); border-left: 3px solid var(--ink); padding: 0; overflow: hidden; position: relative; }

        /* BRUTAL CARDS */
        .b-card { background: #fff; border: 2px solid var(--ink); box-shadow: var(--shadow-hard); padding: 20px; transition: 0.1s; display: flex; flex-direction: column; }
        .b-card:hover { transform: translate(2px, 2px); box-shadow: var(--shadow-hover); }
        .b-card a { text-decoration: none; color: inherit; }

        /* QUICK ACCESS */
        .res-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .res-card { height: 100%; justify-content: center; align-items: flex-start; gap: 15px; padding: 25px; background: #fff; }
        .res-icon { font-size: 24px; color: var(--accent); }
        .res-title { font-weight: 700; font-size: 16px; margin-bottom: 5px; }
        .res-sub { font-family: 'JetBrains Mono'; font-size: 11px; color: var(--ink-dim); }
        
        /* WIDGETS */
        .section-label { 
            font-family: 'JetBrains Mono'; font-weight: 700; background: var(--ink); color: #fff; 
            display: inline-block; padding: 4px 8px; font-size: 12px; margin-bottom: 15px;
            box-shadow: 4px 4px 0px var(--highlight);
        }
        .widgets-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; min-height: 300px; }
        .dash-widget { justify-content: space-between; position: relative; background: #fff; cursor: pointer; }
        .widget-header { display: flex; justify-content: space-between; border-bottom: 2px solid var(--ink); padding-bottom: 10px; margin-bottom: 20px; }
        .w-title { font-family: 'JetBrains Mono'; font-weight: 700; text-transform: uppercase; font-size: 12px; }
        
        .next-event-title { font-size: 28px; font-weight: 700; line-height: 1.1; margin-bottom: 20px; }
        .time-tag { background: var(--highlight); border: 2px solid var(--ink); padding: 8px 12px; font-family: 'JetBrains Mono'; font-weight: 700; font-size: 14px; display: inline-block; }
        
        .leader-content { text-align: center; }
        .leader-avatar { width: 80px; height: 80px; object-fit: cover; border: 2px solid var(--ink); box-shadow: 4px 4px 0px var(--accent); margin-bottom: 15px; }
        .leader-name { font-size: 22px; font-weight: 700; background: var(--ink); color: #fff; display: inline-block; padding: 2px 8px; margin-bottom: 8px;}
        .leader-role { font-family: 'JetBrains Mono'; font-size: 12px; color: var(--accent); font-weight: 700; text-transform: uppercase; }

        /* ROADMAP */
        .roadmap-card { border: 2px solid var(--ink); background: #fff; padding: 25px; box-shadow: var(--shadow-hard); display: flex; align-items: center; justify-content: space-between; }
        .rm-step { text-align: center; flex: 1; position: relative; opacity: 0.5; }
        .rm-step.active { opacity: 1; }
        .rm-step::after { content:''; height: 2px; background: var(--ink); width: 100%; position: absolute; top: 15px; left: 50%; z-index: 0; }
        .rm-step:last-child::after { display: none; }
        .rm-icon { width: 30px; height: 30px; background: #fff; border: 2px solid var(--ink); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; position: relative; z-index: 1; font-weight: 700; font-family: 'JetBrains Mono'; }
        .rm-step.active .rm-icon { background: var(--highlight); box-shadow: 2px 2px 0px var(--ink); }
        .rm-label { font-weight: 700; font-size: 14px; }

        /* TABS (Centered) */
        .container-center { width: 100%; max-width: 900px; margin: 0 auto; padding: 40px; }
        .sub-nav { display: flex; justify-content: center; gap: 15px; margin-bottom: 40px; }
        .sub-btn { padding: 10px 20px; font-family: 'JetBrains Mono'; font-weight: 700; font-size: 12px; background: #fff; border: 2px solid var(--ink); cursor: pointer; text-transform: uppercase; box-shadow: 4px 4px 0px #ccc; transition: 0.1s; }
        .sub-btn:hover { transform: translate(2px,2px); box-shadow: 2px 2px 0px #ccc; }
        .sub-btn.active { background: var(--accent); color: #fff; box-shadow: 4px 4px 0px var(--ink); border-color: var(--ink); }

        /* Hall of Fame */
        .spotlight-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .spot-card { padding: 0; }
        .spot-card .img-box { height: 160px; border-bottom: 2px solid var(--ink); background: #eee; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .spot-card img { width: 100%; height: 100%; object-fit: cover; filter: grayscale(100%); transition: 0.2s; }
        .spot-card:hover img { filter: grayscale(0%); }
        .spot-info { padding: 20px; }
        .spot-tag { font-family: 'JetBrains Mono'; font-size: 10px; background: var(--ink); color: #fff; padding: 2px 6px; text-transform: uppercase; }
        .spot-title { font-weight: 700; margin-top: 10px; font-size: 16px; line-height: 1.3; }

        /* Events */
        .event-row { display: flex; gap: 20px; align-items: center; background: #fff; border: 2px solid var(--ink); padding: 15px; margin-bottom: 15px; box-shadow: var(--shadow-hard); transition: 0.1s; }
        .event-row:hover { transform: translate(2px,2px); box-shadow: var(--shadow-hover); }
        .date-box { width: 60px; height: 60px; background: var(--ink); color: #fff; display: flex; flex-direction: column; align-items: center; justify-content: center; font-family: 'JetBrains Mono'; border: 2px solid var(--ink); }
        .date-d { font-size: 20px; font-weight: 700; } .date-m { font-size: 12px; color: var(--highlight); }
        .ev-btn { margin-left: auto; background: var(--accent); color: #fff; padding: 10px 20px; text-decoration: none; font-family: 'JetBrains Mono'; font-size: 12px; border: 2px solid var(--ink); font-weight: 700; }

        /* Leaderboard */
        .lb-podium { display: flex; justify-content: center; align-items: flex-end; gap: 20px; margin-bottom: 50px; min-height: 250px; }
        .podium-card { background: #fff; border: 2px solid var(--ink); padding: 15px; text-align: center; width: 160px; box-shadow: var(--shadow-hard); position: relative; transition: 0.3s; display: flex; flex-direction: column; align-items: center; }
        .podium-card.rank-1 { height: 260px; background: var(--highlight); z-index: 2; transform: scale(1.05); }
        .p-rank { position: absolute; top: -15px; width: 30px; height: 30px; background: var(--ink); color: #fff; font-family: 'JetBrains Mono'; font-weight: 700; display: flex; align-items: center; justify-content: center; border: 2px solid var(--ink); }
        .p-avatar { width: 60px; height: 60px; object-fit: cover; border: 2px solid var(--ink); margin-bottom: 10px; background: #fff; }
        .p-name { font-weight: 700; font-size: 16px; margin-bottom: 5px; background: #fff; padding: 2px 5px; border: 1px solid var(--ink); display: inline-block; }
        .p-points { font-family: 'JetBrains Mono'; font-size: 12px; font-weight: 700; }

        .list-row { display: flex; align-items: center; background: #fff; border: 2px solid var(--ink); padding: 15px 20px; margin-bottom: 10px; box-shadow: 4px 4px 0px rgba(0,0,0,0.1); transition: 0.1s; }
        .list-row:hover { transform: translate(2px,2px); box-shadow: 2px 2px 0px rgba(0,0,0,0.1); border-color: var(--accent); }
        .row-rank { font-family: 'JetBrains Mono'; font-weight: 700; font-size: 16px; width: 40px; color: var(--ink-dim); }
        .row-avatar { width: 40px; height: 40px; border: 2px solid var(--ink); object-fit: cover; margin-right: 20px; }
        .row-role-tag { font-size: 10px; font-family: 'JetBrains Mono'; font-weight: 700; text-transform: uppercase; padding: 2px 6px; border: 1px solid var(--ink); display: inline-block; margin-top: 4px; }
        .row-points { font-family: 'JetBrains Mono'; font-weight: 700; font-size: 13px; color: var(--text-main); }

        @media (max-width: 900px) {
            .dash-container { grid-template-columns: 1fr; }
            .dash-right { display: none; }
            .interface { height: auto; min-height: 100vh; border: none; width: 100%; max-width: none; }
            .widgets-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="interface">
        <header>
            <div class="logo-group">
                <!-- Вставьте ссылку на логотип -->
                <img src="https://placehold.co/40x40?text=Pi2" alt="Pi2" class="custom-logo">
                <div class="logo-text">Pi Squared</div>
            </div>
            <div class="badge"><div class="dot"></div>DEVNET LIVE</div>
        </header>

        <nav>
            <button class="nav-btn active" onclick="switchTab('dashboard')">Dashboard</button>
            <button class="nav-btn" onclick="switchTab('spotlight')">Hall of Fame</button>
            <button class="nav-btn" onclick="switchTab('events')">Events</button>
            <button class="nav-btn" onclick="switchTab('leaderboard')">Leaderboard</button>
        </nav>

        <div class="screen">
            
            <!-- 1. DASHBOARD -->
            <div id="tab-dashboard" class="tab-content active">
                <div class="dash-container">
                    <div class="dash-left">
                        <div class="dash-wrapper">
                            
                            <!-- Quick Access -->
                            <div>
                                <div class="section-label">QUICK_ACCESS.EXE</div>
                                <div class="res-grid">
                                    <a href="https://pi2.network/" target="_blank" class="res-card b-card">
                                        <i class="fa-solid fa-globe res-icon"></i>
                                        <div class="res-title">Website</div>
                                        <div class="res-sub">Official Portal</div>
                                    </a>
                                    <a href="https://docs.pi2.network/" target="_blank" class="res-card b-card">
                                        <i class="fa-solid fa-book res-icon"></i>
                                        <div class="res-title">Docs</div>
                                        <div class="res-sub">For Devs</div>
                                    </a>
                                    <a href="https://discord.com/invite/NdBJBZMz4e" target="_blank" class="res-card b-card">
                                        <i class="fa-brands fa-discord res-icon"></i>
                                        <div class="res-title">Discord</div>
                                        <div class="res-sub">Join DAO</div>
                                    </a>
                                </div>
                            </div>

                            <!-- Live Status -->
                            <div>
                                <div class="section-label">SYSTEM_STATUS</div>
                                <div class="widgets-row">
                                    <div class="dash-widget b-card" onclick="switchTab('events')">
                                        <div class="widget-header">
                                            <span class="w-title">Next Event</span>
                                            <i class="fa-regular fa-calendar"></i>
                                        </div>
                                        <div id="dash-event-title" class="next-event-title">Loading...</div>
                                        <div id="dash-event-time" class="time-tag">...</div>
                                    </div>
                                    
                                    <div class="dash-widget b-card" onclick="switchTab('leaderboard')">
                                        <div class="widget-header">
                                            <span class="w-title">Top Agent</span>
                                            <i class="fa-solid fa-medal"></i>
                                        </div>
                                        <div class="leader-content">
                                            <img id="dash-top-avatar" class="leader-avatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23000'/%3E%3C/svg%3E">
                                            <div id="dash-top-user" class="leader-name">...</div>
                                            <div id="dash-top-role" class="leader-role">RANK 1</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Roadmap -->
                            <div>
                                <div class="section-label">ROADMAP_SEQUENCE</div>
                                <div class="roadmap-card">
                                    <div class="rm-step completed"><div class="rm-icon"><i class="fa-solid fa-check"></i></div><div class="rm-label">DEVNET</div></div>
                                    <div class="rm-step active"><div class="rm-icon">2</div><div class="rm-label">TESTNET</div></div>
                                    <div class="rm-step"><div class="rm-icon">3</div><div class="rm-label">MAINNET</div></div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <!-- Twitter -->
                    <div class="dash-right">
                         <div style="background:#000; color:#fff; padding:10px; font-family:'JetBrains Mono'; font-size:12px; border-bottom:3px solid var(--ink);"> >_ TWITTER_FEED</div>
                        <a class="twitter-timeline" data-height="800" data-theme="light" data-chrome="noheader nofooter transparent" href="https://twitter.com/PiSquared?ref_src=twsrc%5Etfw">
                            <div style="padding:40px; text-align:center; font-family:'JetBrains Mono'">Fetching Stream...</div>
                        </a> 
                        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                    </div>
                </div>
            </div>

            <!-- 2. HALL OF FAME -->
            <div id="tab-spotlight" class="tab-content">
                <div class="container-center">
                    <div id="spotlight-container" class="spotlight-grid">
                        <div style="grid-column:1/-1; text-align:center;">Querying Database...</div>
                    </div>
                </div>
            </div>

            <!-- 3. EVENTS -->
            <div id="tab-events" class="tab-content">
                <div class="container-center">
                    <div id="events-container" style="display:flex; flex-direction:column; gap:20px;"></div>
                </div>
            </div>

            <!-- 4. LEADERBOARD -->
            <div id="tab-leaderboard" class="tab-content">
                <div class="container-center">
                    <div class="sub-nav">
                        <button class="sub-btn active" onclick="filterLeaderboard('All', this)">ALL UNITS</button>
                        <button class="sub-btn" onclick="filterLeaderboard('Harmony', this)">HARMONY</button>
                        <button class="sub-btn" onclick="filterLeaderboard('Luminary', this)">LUMINARY</button>
                        <button class="sub-btn" onclick="filterLeaderboard('Catalyst', this)">CATALYST</button>
                        <button class="sub-btn" onclick="filterLeaderboard('Neophyte', this)">NEOPHYTE</button>
                    </div>
                    <div id="lb-podium" class="lb-podium"></div>
                    <div id="lb-list" style="display:flex; flex-direction:column; gap:10px;"></div>
                </div>
            </div>

        </div>
    </div>

    <script>
        const SUPABASE_URL = 'https://opaflgqsawxkoeptszwt.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9wYWZsZ3FzYXd4a29lcHRzend0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5NzA5MDcsImV4cCI6MjA4MTU0NjkwN30.PwKgM49pValst9gSSDWCWJrfsCkD5JXQXB4qh9OSAJY';
        const client = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        const ROLES = {
            "Harmony": { color: "#FF0080", label: "Harmony" },
            "Luminary": { color: "#F59E0B", label: "Luminary" },
            "Catalyst": { color: "#7F2FFF", label: "Catalyst" },
            "Neophyte": { color: "#3B82F6", label: "Neophyte" }
        };

        let data = { spotlight: [], events: [], leaderboard: [] };
        let currentLbFilter = 'All';

        document.addEventListener('DOMContentLoaded', init);

        async function init() {
            renderDashboard();
            await fetchData();
            renderDashboard();
            renderHub();
            renderLeaderboard();
        }

        async function fetchData() {
            let { data: s } = await client.from('spotlight').select('*').order('id', {ascending: false});
            if(s) data.spotlight = s;
            let { data: e } = await client.from('events').select('*').order('sort_date', {ascending: true});
            if(e) data.events = e;
            let { data: l } = await client.from('leaderboard').select('*');
            if(l) data.leaderboard = l;
        }

        function renderDashboard() {
            if(data.events[0]) {
                document.getElementById('dash-event-title').innerText = data.events[0].title;
                document.getElementById('dash-event-time').innerText = `${data.events[0].day} ${data.events[0].month} // ${data.events[0].time}`;
            }
            if(data.leaderboard[0]) {
                const top = data.leaderboard.sort((a,b)=>b.points-a.points)[0];
                document.getElementById('dash-top-user').innerText = top.username;
                document.getElementById('dash-top-role').innerText = top.role.toUpperCase();
                const avatarUrl = top.handle ? `https://unavatar.io/twitter/${top.handle}` : top.avatar;
                if(avatarUrl) document.getElementById('dash-top-avatar').src = avatarUrl;
            }
        }

        function renderHub() {
            document.getElementById('spotlight-container').innerHTML = data.spotlight.map(i => `
                <div class="b-card spot-card">
                    <div class="img-box"><img src="${i.img}" onerror="this.style.display='none'"></div>
                    <div class="spot-info">
                        <span class="spot-tag">${i.tag}</span>
                        <div class="spot-title">${i.title}</div>
                        <a href="${i.link}" target="_blank" style="font-size:12px; font-weight:700; margin-top:10px; display:block;">>> READ_MORE</a>
                    </div>
                </div>
            `).join('');

            document.getElementById('events-container').innerHTML = data.events.map(ev => `
                <div class="event-row">
                    <div class="date-box"><span class="date-d">${ev.day}</span><span class="date-m">${ev.month}</span></div>
                    <div style="flex:1">
                        <div style="font-weight:700; font-size:18px;">${ev.title}</div>
                        <div style="font-family:'JetBrains Mono'; font-size:12px; color:#555;">${ev.time}</div>
                    </div>
                    <a href="${ev.link}" target="_blank" class="ev-btn">RSVP</a>
                </div>
            `).join('');
        }

        function filterLeaderboard(role, btn) {
            currentLbFilter = role;
            document.querySelectorAll('.sub-nav .sub-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');
            renderLeaderboard();
        }

        function renderLeaderboard() {
            let list = [...data.leaderboard].sort((a,b) => b.points - a.points);
            if(currentLbFilter !== 'All') list = list.filter(u => u.role === currentLbFilter);
            
            const podiumEl = document.getElementById('lb-podium');
            const listEl = document.getElementById('lb-list');
            if(list.length === 0) { podiumEl.innerHTML = ''; listEl.innerHTML = '<div style="text-align:center;color:#555">NO DATA FOUND</div>'; return; }

            let top3 = list.slice(0, 3);
            let rest = list.slice(3);

            podiumEl.innerHTML = top3.map((u, i) => {
                const rank = i + 1;
                const roleData = ROLES[u.role] || {color:'#ccc'};
                const avSrc = u.handle ? `https://unavatar.io/twitter/${u.handle}` : u.avatar;
                return `<div class="podium-card rank-${rank}"><div class="p-rank">${rank}</div><img src="${avSrc}" class="p-avatar"><div class="p-name">${u.username}</div><div class="p-points">${u.points} XP</div></div>`;
            }).join('');

            listEl.innerHTML = rest.map((u, i) => {
                const rank = i + 4;
                const roleData = ROLES[u.role] || {color:'#ccc', label:u.role};
                const avSrc = u.handle ? `https://unavatar.io/twitter/${u.handle}` : u.avatar;
                return `<div class="list-row"><div class="row-rank">#${rank}</div><img src="${avSrc}" class="row-avatar"><div style="flex:1"><div style="font-weight:700">${u.username}</div><div class="row-role-tag" style="background:${roleData.color}; color:#fff; padding:2px 6px;">${u.role.toUpperCase()}</div></div><div class="row-points">${u.points} XP</div></div>`;
            }).join('');
        }

        window.switchTab = (id) => {
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            event.currentTarget.classList.add('active');
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById('tab-' + id).classList.add('active');
        }
    </script>
</body>
</html>
